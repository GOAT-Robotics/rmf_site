<html>

<head>
  <meta charset="utf-8">
  <title>The RMF Site Editor</title>
  <style>
    body {
      background-color: #101010;
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }

    canvas {
      background-color: #401010;
    }
  </style>
</head>

<body>
  <canvas id="rmf_site_editor_canvas">
    <script type="module">
      import init, { run_js_new_site } from "./librmf_site_editor.js";

      document.addEventListener('contextmenu', function (evt) { evt.preventDefault(); });

      try {
        let wasm = await init("./librmf_site_editor_bg_optimized.wasm");
        window.wasm = wasm

        // https://filebin.net/sf1ynff67v7chf0t/test.site.ron
        // https://filebin.net/olo599ws5cvyjpil/hotel.building.yaml

        // let data = await fetch("https://filebin.net/sf1ynff67v7chf0t/test.site.ron");
        // let text = await data.text();

        // // convert text to Unit8Array
        // let bytes = new TextEncoder().encode(text);

        // possible 2nd parameter:
        // 1. building.yaml
        // 2. site.ron

        window.save_map = function (buildingId, data) {
          console.log('Received data from wasm for buildingId' + buildingId)
          console.log(data)
        }

        //run_js_with_data([], "new.site", "uuid_building_id");
        run_js_new_site("uuid_building_id")
      } catch (e) {
        console.error(e);
      }

    </script>
  </canvas>
</body>

</html>